# Virtual Host Configuration for Rocky Linux 9
# This file contains the virtual host settings

# HTTP Virtual Host
<VirtualHost *:{{ http_port }}>
    ServerName {{ server_name }}
    ServerAlias www.{{ server_name }}
    DocumentRoot {{ document_root }}
    ServerAdmin webmaster@{{ server_name }}
    
    # Directory configuration
    <Directory "{{ document_root }}">
        Options Indexes FollowSymLinks MultiViews
        AllowOverride All
        Require all granted
        
        # Security headers
        Header always set X-Content-Type-Options nosniff
        Header always set X-Frame-Options DENY
        Header always set X-XSS-Protection "1; mode=block"
        Header always set Referrer-Policy "strict-origin-when-cross-origin"
    </Directory>
    
    # Error and access logs
    ErrorLog logs/{{ server_name }}_error.log
    CustomLog logs/{{ server_name }}_access.log combined
    
    # Enable .htaccess files
    <Files ".ht*">
        Require all denied
    </Files>
    
    # Default index files
    DirectoryIndex index.html index.htm index.php
    
    # Handle 404 errors
    ErrorDocument 404 /404.html
    
    # Performance settings
    EnableSendfile On
    EnableMMAP On
</VirtualHost>

# HTTPS Virtual Host (commented out - uncomment when SSL is configured)
#<VirtualHost *:{{ https_port }}>
#    ServerName {{ server_name }}
#    ServerAlias www.{{ server_name }}
#    DocumentRoot {{ document_root }}
#    ServerAdmin webmaster@{{ server_name }}
#    
#    SSLEngine on
#    SSLCertificateFile /etc/pki/tls/certs/{{ server_name }}.crt
#    SSLCertificateKeyFile /etc/pki/tls/private/{{ server_name }}.key
#    SSLCertificateChainFile /etc/pki/tls/certs/{{ server_name }}_chain.crt
#    
#    # Security headers for HTTPS
#    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
#    Header always set X-Content-Type-Options nosniff
#    Header always set X-Frame-Options DENY
#    Header always set X-XSS-Protection "1; mode=block"
#    Header always set Referrer-Policy "strict-origin-when-cross-origin"
#    
#    # Error and access logs
#    ErrorLog logs/{{ server_name }}_ssl_error.log
#    CustomLog logs/{{ server_name }}_ssl_access.log combined
#    
#    # Directory configuration
#    <Directory "{{ document_root }}">
#        Options Indexes FollowSymLinks MultiViews
#        AllowOverride All
#        Require all granted
#    </Directory>
#</VirtualHost> 